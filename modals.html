<div id="contact-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="close-modal" class="close-button">&times;</button>
        <h2>Frag Michael!</h2>
        <form id="contact-form-inner">
            <input type="text" name="name" placeholder="Dein Name (oder KÃ¼nstlername):" required>
            <input type="email" name="email" placeholder="Deine E-Mail (Anti-Spam-Zone!)" required>
            <input type="text" name="_subject" placeholder="Worum geht's? (Bitte kein KI-Drama)">
            <textarea name="message" placeholder="Deine Botschaft an mich (und Evita):" rows="5" required></textarea>
            <div class="privacy-checkbox">
                <input type="checkbox" name="privacy" id="privacy" required>
                <label for="privacy">Michael darf meine Nachricht lesen und Evita darf alles verarbeiten, was sie versteht. (Details im Datenschutz)</label>
            </div>
            <button type="submit" class="cta-button">Ab die Post!</button>
        </form>
        <div id="contact-success-message" class="contact-success-hidden">
            <h2>Nachricht empfangen! </h2>
            <p>Michael (oder Evita, wenn er zu sehr bastelt) meldet sich in KÃ¼rze.</p>
            <p class="success-close-wrapper"><a href="#" id="close-success-message" class="cta-button">SchlieÃŸen</a></p>
        </div>
    </div>
</div>

<div id="cookie-info-lightbox" class="modal-overlay">
    <div class="modal-content">
        <h2>Hinweis zu Cookies</h2>
        <p class="cookie-info-text">Wir backen hier nur Cookies, die unsere Website am Laufen halten. Reine Technik, kein Schnickschnack!</p>
        <div class="cookie-lightbox-buttons">
            <a href="datenschutz.html" id="privacy-policy-link-button" class="lightbox-button">DatenschutzerklÃ¤rung</a>
            <button id="acknowledge-cookie-lightbox" class="lightbox-button">Alles klar</button>
        </div>
    </div>
</div>

<div id="legal-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="close-legal-modal" class="close-button">&times;</button>
        <div id="legal-modal-content-area"></div>
    </div>
</div>

<div id="ai-response-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="close-ai-response-modal-top" class="close-button">&times;</button>
        
        <div id="ai-chat-history">
            </div>

        <form id="ai-chat-form" autocomplete="off">
            <input type="text" 
                   id="ai-chat-input" 
                   placeholder="Frag Evita..." 
                   autocomplete="off" 
                   required
                   data-chat-input="true">
            <button type="submit" aria-label="Senden">
                <i class="fa-regular fa-paper-plane"></i>
            </button>
        </form>
    </div>
</div>

<div id="debug-booking-trigger" style="position: fixed; bottom: 80px; right: 20px; z-index: 9999; display: none;">
    <button onclick="window.debugBookingLaunch && window.debugBookingLaunch()" 
            style="background: #28a745; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer;">
        ðŸ”§ Test Booking
    </button>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('ðŸ”§ Modal-Ereignis-Setup wird geladen...');
    
    // Zeige Debug-Button in Entwicklungsumgebung
    if (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1') || window.location.search.includes('debug=true')) {
        const debugButton = document.getElementById('debug-booking-trigger');
        if (debugButton) {
            debugButton.style.display = 'block';
        }
    }
    
    // FALLBACK: Stelle sicher, dass Chat-Submit-Events verarbeitet werden
    let chatSubmitBackup = false;
    
    const setupChatBackup = () => {
        const chatForm = document.getElementById('ai-chat-form');
        const chatInput = document.getElementById('ai-chat-input');
        
        if (chatForm && chatInput && !chatSubmitBackup) {
            console.log('ðŸ”§ Richte Chat-Backup-Handler ein...');
            
            // Backup Submit Handler
            chatForm.addEventListener('submit', function(e) {
                console.log('ðŸ”§ Chat-Backup-Submit ausgelÃ¶st');
            });
            
            // Backup Enter-Handler
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    console.log('ðŸ”§ Chat-Backup-Enter ausgelÃ¶st');
                    e.preventDefault();
                    chatForm.dispatchEvent(new Event('submit', {bubbles: true}));
                }
            });
            
            chatSubmitBackup = true;
        }
    };
    
    // Versuche Chat-Backup sofort und nach kurzer VerzÃ¶gerung
    setupChatBackup();
    setTimeout(setupChatBackup, 500);
    setTimeout(setupChatBackup, 1000);
    
    // Ãœberwache Modal-Ã„nderungen fÃ¼r dynamisch geladene Inhalte
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
                setupChatBackup();
            }
        });
    });
    
    const modalContainer = document.getElementById('modal-container');
    if (modalContainer) {
        observer.observe(modalContainer, {
            childList: true,
            subtree: true
        });
    }
});
</script>
